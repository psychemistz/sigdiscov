% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/permutation.R
\name{permutation_test_IND_sc}
\alias{permutation_test_IND_sc}
\title{Permutation Test for Single-Cell ST with Signature Computation}
\usage{
permutation_test_IND_sc(
  expr_matrix,
  cell_meta,
  factor_gene,
  sender_type,
  receiver_type,
  radii = seq(20, 100, 20),
  n_perm = 999,
  seed = NULL,
  adjust_method = "BH",
  verbose = TRUE
)
}
\arguments{
\item{expr_matrix}{Gene expression matrix (genes x cells).}

\item{cell_meta}{Data frame with cell metadata.}

\item{factor_gene}{Name or index of factor gene.}

\item{sender_type}{Sender cell type.}

\item{receiver_type}{Receiver cell type.}

\item{radii}{Distance bins in micrometers. Default: seq(20, 100, 20).}

\item{n_perm}{Number of permutations. Default: 999.}

\item{seed}{Random seed.}

\item{adjust_method}{P-value adjustment method. Default: "BH".}

\item{verbose}{Print progress. Default: TRUE.}
}
\value{
A data.frame with columns:
  \item{gene}{Gene name}
  \item{I_ND_r1}{I_ND at first radius}
  \item{delta_I}{Signed delta I (spatial decay signature)}
  \item{p_value}{Permutation p-value for I_ND_r1}
  \item{p_adj}{Adjusted p-value}
  \item{z_score}{Standardized effect size}
}
\description{
Combines I_ND signature computation with permutation testing.
Computes I_ND at multiple radii and tests significance at the first radius.
}
\examples{
\dontrun{
result <- permutation_test_IND_sc(
    expr_matrix = cosmx_expr,
    cell_meta = meta,
    factor_gene = "IL1B",
    sender_type = "Macrophage",
    receiver_type = "Fibroblast",
    radii = seq(20, 100, 20),
    n_perm = 999
)

# Significant responders (positive I_ND, FDR < 0.05)
responders <- result[result$p_adj < 0.05 & result$I_ND_r1 > 0, ]
}

}
