% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/signed_delta_I.R
\name{compute_signed_delta_I}
\alias{compute_signed_delta_I}
\title{Compute Signed Delta I for a Single Factor}
\usage{
compute_signed_delta_I(
  expr_matrix,
  spot_coords,
  factor_gene,
  radii = seq(100, 600, 100),
  mode = c("bivariate", "directional"),
  sender_percentile = 75,
  smooth_window = 5,
  smooth_poly = 2,
  coord_scale = 1,
  verbose = TRUE
)
}
\arguments{
\item{expr_matrix}{A matrix of gene expression values (genes x spots). VST-normalized recommended.}

\item{spot_coords}{Spot coordinates as a data frame with row/col columns, or a 2-column matrix.}

\item{factor_gene}{Name or row index of the factor gene.}

\item{radii}{Numeric vector of distance bin edges. Default: seq(100, 600, 100).}

\item{mode}{Computation mode: "bivariate" (Moran's I) or "directional" (I_ND). Default: "bivariate".}

\item{sender_percentile}{For directional mode: percentile threshold for senders. Default: 75.}

\item{smooth_window}{Savitzky-Golay smoothing window size (must be odd). Default: 5.}

\item{smooth_poly}{Savitzky-Golay polynomial order. Default: 2.}

\item{coord_scale}{Scale factor for coordinates. Default: 1.}

\item{verbose}{Print progress messages. Default: TRUE.}
}
\value{
A data frame with columns: gene, delta_I, delta_I_signed, sign, I_short, I_long, I_max, I_min, auc, peak_radius_idx.
}
\description{
Computes distance-dependent spatial correlation between a factor gene and all
other genes, then derives signed delta I signatures.
}
\details{
Interpretation:
\itemize{
  \item delta_I_signed > 0: Decay pattern (TRUE RESPONDER)
  \item delta_I_signed < 0: Increase pattern (AVOIDANCE)
  \item delta_I_signed ~ 0: Flat pattern (CONSTITUTIVE)
}
}
\examples{
\dontrun{
sig <- compute_signed_delta_I(expr_vst, coords, factor_gene = "IL1B")
head(sig[order(-sig$delta_I_signed), ])
}

}
