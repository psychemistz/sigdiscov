% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/singlecell.R
\name{compute_IND_multi_factor}
\alias{compute_IND_multi_factor}
\title{Compute I_ND for Multiple Factors (Optimized)}
\usage{
compute_IND_multi_factor(
  expr_matrix,
  cell_meta,
  factor_genes,
  sender_type,
  receiver_type,
  radii = seq(20, 200, 20),
  min_cells = 30,
  smooth_window = 5,
  smooth_poly = 2,
  verbose = TRUE
)
}
\arguments{
\item{expr_matrix}{Gene expression matrix (genes x cells).}

\item{cell_meta}{Data frame with cell metadata.}

\item{factor_genes}{Character vector of factor gene names.}

\item{sender_type}{Cell type for sender cells.}

\item{receiver_type}{Cell type for receiver cells.}

\item{radii}{Distance bins in micrometers. Default: seq(20, 200, 20).}

\item{min_cells}{Minimum cells per type required. Default: 30.}

\item{smooth_window}{Smoothing window size. Default: 5.}

\item{smooth_poly}{Polynomial order. Default: 2.}

\item{verbose}{Print progress messages. Default: TRUE.}
}
\value{
A named list of data frames, one per factor gene.
}
\description{
Efficiently computes I_ND signatures for multiple factor genes against a single
(sender_type, receiver_type) pair. This is much faster than calling compute_IND_sc
multiple times because weight matrices are computed only once.
}
\details{
\strong{Optimization:} This function precomputes:
\enumerate{
  \item Weight matrices for all radii (once per sender-receiver pair)
  \item Spatial lags for all genes (W * z_g for each radius)
}
Then it only needs to compute factor-specific operations for each factor,
which is O(n_factors * n_genes * n_radii) dot products instead of
O(n_factors * n_senders * n_receivers) distance calculations.
}
\examples{
\dontrun{
# Compute signatures for multiple cytokines efficiently
results <- compute_IND_multi_factor(
    expr_matrix = expr,
    cell_meta = meta,
    factor_genes = c("IL1B", "TGFB1", "IFNG", "TNF"),
    sender_type = "Macrophage",
    receiver_type = "Fibroblast"
)

# Access results for each factor
il1b_sig <- results$IL1B
}

}
