% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/singlecell.R
\name{compute_IND_all_pairs}
\alias{compute_IND_all_pairs}
\title{Compute I_ND for All Cell Type Pairs and Multiple Factors (Optimized)}
\usage{
compute_IND_all_pairs(
  expr_matrix,
  cell_meta,
  factor_genes,
  cell_types_include = NULL,
  radii = seq(20, 200, 20),
  min_cells = 30,
  verbose = TRUE
)
}
\arguments{
\item{expr_matrix}{Gene expression matrix (genes x cells).}

\item{cell_meta}{Data frame with cell metadata.}

\item{factor_genes}{Character vector of factor gene names. If NULL, uses a single factor.}

\item{cell_types_include}{Cell types to include. Default: all types with sufficient cells.}

\item{radii}{Distance bins in micrometers. Default: seq(20, 200, 20).}

\item{min_cells}{Minimum cells per type required. Default: 30.}

\item{verbose}{Print progress messages. Default: TRUE.}
}
\value{
A nested named list: result[[pair_name]][[factor_name]] gives the data.frame
  for that combination. If only one factor, result[[pair_name]] gives the data.frame directly.
}
\description{
Efficiently computes I_ND signatures for multiple factor genes across all
sender-receiver cell type combinations. Optimized to precompute weight matrices
once per cell type pair.
}
\details{
\strong{Optimization Strategy:}
For each (sender_type, receiver_type) pair:
\enumerate{
  \item Compute weight matrices once (expensive: O(n_senders * n_receivers))
  \item Compute spatial lags for all genes once
  \item Process all factors using precomputed data (cheap: just dot products)
}

This is much faster than the naive approach of calling compute_IND_sc for each
(factor, sender, receiver) combination separately.
}
\examples{
\dontrun{
# Compute for multiple cytokines across all cell type pairs
all_results <- compute_IND_all_pairs(
    expr_matrix = expr,
    cell_meta = meta,
    factor_genes = c("IL1B", "TGFB1", "IFNG"),
    cell_types_include = c("Macrophage", "Fibroblast", "Epithelial")
)

# Access results
il1b_macro_fibro <- all_results$Macrophage_to_Fibroblast$IL1B
}

}
