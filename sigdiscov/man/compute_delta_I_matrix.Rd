% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/signed_delta_I.R
\name{compute_delta_I_matrix}
\alias{compute_delta_I_matrix}
\title{Compute Delta I Matrix}
\usage{
compute_delta_I_matrix(
  expr_matrix,
  spot_coords,
  radii = seq(150, 650, 100),
  weight_type = c("ring", "circular"),
  correlation_type = c("moran", "ind"),
  chunk_size = 1000,
  smooth_window = 5,
  smooth_poly = 2,
  coord_scale = 1,
  verbose = TRUE
)
}
\arguments{
\item{expr_matrix}{A matrix of gene expression values (genes x spots). VST-normalized recommended.}

\item{spot_coords}{Spot coordinates as a data frame with row/col columns, or a 2-column matrix.}

\item{radii}{Numeric vector of distance bin edges. Default: seq(150, 650, 100).}

\item{weight_type}{Neighbor definition: "ring" or "circular". Default: "ring".}

\item{correlation_type}{Correlation measure: "moran" or "ind". Default: "moran".}

\item{chunk_size}{Number of genes per chunk for memory efficiency. Default: 1000.}

\item{smooth_window}{Savitzky-Golay smoothing window size (must be odd). Default: 5.}

\item{smooth_poly}{Savitzky-Golay polynomial order. Default: 2.}

\item{coord_scale}{Scale factor for coordinates. Default: 1.}

\item{verbose}{Print progress messages. Default: TRUE.}
}
\value{
A list with:
\itemize{
  \item delta_I_signed: n_genes x n_genes matrix
  \item n_genes, n_spots, n_radii: dimensions
  \item weight_type, correlation_type: method parameters
}
}
\description{
Compute delta I matrix for ALL gene pairs. Supports 4 methods:
\itemize{
  \item ring + moran: Ring-based Moran's I (default)
  \item ring + ind: Ring-based I_ND
  \item circular + moran: Circular Moran's I
  \item circular + ind: Circular I_ND
}
}
\details{
\strong{Weight Types:}
\itemize{
  \item Ring: Neighbors in distance band [r_inner, r_outer)
  \item Circular: All neighbors in cumulative disk [0, r_outer)
}

\strong{Correlation Types:}
\itemize{
  \item Moran's I: I = z_f' * W * z_g / n
  \item I_ND: I_ND = dot(z_f, W*z_g) / (||z_f|| * ||W*z_g||)
}
}
\examples{
\dontrun{
# Ring-based Moran's I (default)
result <- compute_delta_I_matrix(expr_vst, coords)

# Circular I_ND
result <- compute_delta_I_matrix(expr_vst, coords,
                                  weight_type = "circular",
                                  correlation_type = "ind")
}

}
