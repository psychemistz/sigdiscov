% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/signed_delta_I.R
\name{get_moran_curve}
\alias{get_moran_curve}
\title{Get Moran's I Curve for a Gene Pair}
\usage{
get_moran_curve(
  expr_matrix,
  spot_coords,
  factor_gene,
  target_gene,
  radii = seq(100, 600, 100),
  mode = c("bivariate", "directional"),
  sender_percentile = 75,
  smooth_window = 5,
  smooth_poly = 2,
  coord_scale = 1
)
}
\arguments{
\item{expr_matrix}{A matrix of gene expression values (genes x spots).}

\item{spot_coords}{Spot coordinates as a data frame or matrix.}

\item{factor_gene}{Name or row index of the factor gene.}

\item{target_gene}{Name or row index of the target gene.}

\item{radii}{Numeric vector of distance bin edges. Default: seq(100, 600, 100).}

\item{mode}{Computation mode: "bivariate" or "directional". Default: "bivariate".}

\item{sender_percentile}{For directional mode: percentile threshold. Default: 75.}

\item{smooth_window}{Savitzky-Golay window size. Default: 5.}

\item{smooth_poly}{Polynomial order. Default: 2.}

\item{coord_scale}{Scale factor for coordinates. Default: 1.}
}
\value{
A list with radii, I_raw, I_smooth, delta_I_signed, and other metrics.
}
\description{
Computes the full I(r) curve for a single factor-gene pair.
}
\examples{
\dontrun{
curve <- get_moran_curve(expr_vst, coords, "IL1B", "COL1A1")
plot(curve$radii, curve$I_smooth, type = "l")
}

}
