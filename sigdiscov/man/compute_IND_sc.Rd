% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/singlecell.R
\name{compute_IND_sc}
\alias{compute_IND_sc}
\title{Compute I_ND Signatures for Single-Cell Spatial Transcriptomics}
\usage{
compute_IND_sc(
  expr_matrix,
  cell_meta,
  factor_gene,
  sender_type,
  receiver_type,
  radii = seq(20, 200, 20),
  min_cells = 30,
  smooth_window = 5,
  smooth_poly = 2,
  verbose = TRUE
)
}
\arguments{
\item{expr_matrix}{Gene expression matrix (genes x cells). Sparse matrix (dgCMatrix) supported.}

\item{cell_meta}{Data frame with cell metadata. Must contain columns:
\itemize{
  \item cell_id: unique identifier matching column names of expr_matrix
  \item x: x-coordinate in micrometers
  \item y: y-coordinate in micrometers
  \item cell_type: cell type annotation
}}

\item{factor_gene}{Name or row index of the factor gene.}

\item{sender_type}{Cell type for sender cells (e.g., "Macrophage").}

\item{receiver_type}{Cell type for receiver cells (e.g., "Fibroblast").}

\item{radii}{Distance bins in micrometers. Default: seq(20, 200, 20).}

\item{min_cells}{Minimum cells per type required. Default: 30.}

\item{smooth_window}{Savitzky-Golay smoothing window size. Default: 5.}

\item{smooth_poly}{Savitzky-Golay polynomial order. Default: 2.}

\item{verbose}{Print progress messages. Default: TRUE.}
}
\value{
A data frame with columns:
  \item{gene}{Gene name}
  \item{I_ND_r1}{I_ND at first (nearest) distance}
  \item{I_ND_max}{Maximum I_ND across all distances}
  \item{delta_I}{Signed delta I (max - min, signed by trend)}
  \item{I_ND_20, I_ND_40, ...}{I_ND at each specified radius}
}
\description{
Computes cell-type-aware I_ND (Normalized Directional Moran's I) signatures
for spatial transcriptomics data with single-cell resolution.
}
\details{
This function implements the (factor, sender_type, receiver_type) triplet structure
for analyzing cell-cell communication in single-cell spatial data:

\strong{Mathematical Formulation:}
\deqn{I_{ND}(f,g,r)_{U \rightarrow V} = \frac{z_U^f \cdot \tilde{W}_r \cdot z_V^g}{\|z_U^f\| \times \|\tilde{W}_r \cdot z_V^g\|}}

Where:
\itemize{
  \item \eqn{z_U^f} = standardized factor expression in sender cells (type U)
  \item \eqn{z_V^g} = standardized gene expression in receiver cells (type V)
  \item \eqn{\tilde{W}_r} = row-normalized weight matrix at distance r
}

\strong{Interpretation:}
\itemize{
  \item delta_I > 0: Decay pattern (spatial responder)
  \item delta_I < 0: Increase pattern (avoidance)
  \item delta_I ~ 0: No distance dependence (constitutive)
}
}
\examples{
\dontrun{
# Load CosMx data
expr <- readRDS("cosmx_expression.rds")
meta <- read.csv("cosmx_metadata.csv")

# Compute I_ND for IL1B: Macrophage -> Fibroblast
signatures <- compute_IND_sc(
    expr_matrix = expr,
    cell_meta = meta,
    factor_gene = "IL1B",
    sender_type = "Macrophage",
    receiver_type = "Fibroblast",
    radii = seq(20, 200, 20)
)

# Top responder genes
head(signatures[order(-signatures$I_ND_r1), ], 20)
}

}
