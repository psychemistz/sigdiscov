% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocess.R
\name{vst_transform}
\alias{vst_transform}
\title{VST Normalization for Spatial Transcriptomics Data}
\usage{
vst_transform(counts, min_cells = 5, n_genes = 2000, verbose = TRUE, ...)
}
\arguments{
\item{counts}{A matrix or sparse matrix of raw counts. Rows are genes, columns are spots.}

\item{min_cells}{Minimum number of cells expressing a gene for it to be included.
Default: 5.}

\item{n_genes}{Number of genes to use for fitting the model. Default: 2000.}

\item{verbose}{Print progress messages. Default: TRUE.}

\item{...}{Additional arguments passed to \code{sctransform::vst}.}
}
\value{
A dense matrix of VST-normalized values. Rows are genes, columns are spots.
  Note: genes that don't meet the min_cells threshold are excluded.
}
\description{
Apply variance stabilizing transformation (VST) using sctransform to normalize
gene expression data. This is the recommended normalization for Moran's I computation.
}
\details{
This function requires the \code{sctransform} package to be installed.
Install it with: \code{install.packages("sctransform")}

The VST normalization:
\enumerate{
  \item Models the relationship between mean expression and variance
  \item Applies a variance stabilizing transformation
  \item Returns Pearson residuals that are approximately normally distributed
}
}
\examples{
\dontrun{
# Load Visium data
visium <- load_visium_data("path/to/spaceranger_output")
visium <- filter_in_tissue(visium)

# Apply VST normalization
data_vst <- vst_transform(visium$counts)

# Compute pairwise Moran's I
coords <- get_spot_coords(visium)
result <- pairwise_moran(data_vst, coords)
}

}
