% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{create_circular_weights_cpp}
\alias{create_circular_weights_cpp}
\title{Create Circular RBF Weight Matrix}
\usage{
create_circular_weights_cpp(coords, radius, sigma = 100, include_self = FALSE)
}
\arguments{
\item{coords}{Spot coordinates matrix (n x 2), physical units (e.g., micrometers)}

\item{radius}{Distance cutoff. Only spots within this radius are connected.}

\item{sigma}{RBF kernel bandwidth. Default: 100.}

\item{include_self}{Include self-connections (diagonal). Default: FALSE.}
}
\value{
A list containing:
\item{W}{Sparse weight matrix (n x n), NOT row-normalized}
\item{weight_sum}{Sum of all weights (S0 for Moran's I normalization)}
}
\description{
Computes a sparse weight matrix using RBF kernel with circular (Euclidean)
distance cutoff. This matches the SpaCET calWeights behavior.
}
\details{
The weight is computed as:
\deqn{w_{ij} = \exp\left(-\frac{d_{ij}^2}{2\sigma^2}\right) \text{ if } d_{ij} \leq r}

where \eqn{d_{ij}} is the Euclidean distance between spots i and j.

This function is designed to match SpaCET's calWeights behavior for
spatial correlation analysis.
}
