% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/permutation.R
\name{adjust_moran_pvalues}
\alias{adjust_moran_pvalues}
\title{Multiple Testing Correction for Moran's I P-values}
\usage{
adjust_moran_pvalues(p_values, method = "BH", include_diagonal = FALSE)
}
\arguments{
\item{p_values}{P-value matrix from \code{moran_permutation_test}}

\item{method}{Correction method passed to \code{p.adjust}:
"BH" (Benjamini-Hochberg, default), "bonferroni", "holm", "BY", etc.}

\item{include_diagonal}{Include diagonal (univariate p-values) in
correction. Default: FALSE.}
}
\value{
Matrix of adjusted p-values with same dimensions as input.
}
\description{
Applies multiple testing correction to p-values from permutation test.
Only adjusts the unique pairs (lower triangle) to avoid over-correction.
}
\examples{
\dontrun{
result <- moran_permutation_test(data, coords, n_perm = 1000)
p_adj <- adjust_moran_pvalues(result$p_values, method = "BH")

# Find significant pairs at FDR < 0.05
sig <- which(p_adj < 0.05 & lower.tri(p_adj), arr.ind = TRUE)
}

}
