% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weights_sc.R
\name{create_weights_sc_large}
\alias{create_weights_sc_large}
\title{Create Scalable Weight Matrix for Large Single-Cell Datasets}
\usage{
create_weights_sc_large(
  coords,
  radius,
  sigma = NULL,
  max_neighbors = 200,
  threshold = 10000,
  verbose = TRUE
)
}
\arguments{
\item{coords}{Cell coordinates (n x 2 matrix)}

\item{radius}{Radius for neighbor search}

\item{sigma}{Gaussian sigma (default: radius/3)}

\item{max_neighbors}{Maximum neighbors per cell (default: 200)}

\item{threshold}{Cell count threshold for using KD-tree (default: 10000)}

\item{verbose}{Print progress messages (default: TRUE)}
}
\value{
List with W (sparse weight matrix), weight_sum, and n_edges
}
\description{
Uses native C++ KD-tree (nanoflann) for efficient neighbor search to create
sparse weight matrices for datasets with >10,000 cells. Falls back to
brute-force for smaller datasets.
}
\details{
For datasets with more than \code{threshold} cells, uses nanoflann C++
KD-tree for O(n log n) neighbor search instead of O(nÂ²) brute-force.
This enables analysis of datasets with hundreds of thousands of cells.
No external R package dependencies required.
}
\examples{
\dontrun{
# Large CosMx dataset (~100k cells)
coords <- as.matrix(meta[, c("x", "y")])
W_result <- create_weights_sc_large(coords, radius = 50, sigma = 20)
}

}
