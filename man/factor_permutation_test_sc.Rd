% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/permutation_sc.R
\name{factor_permutation_test_sc}
\alias{factor_permutation_test_sc}
\title{Permutation Test for Factor-Gene Analysis (Single-Cell)}
\usage{
factor_permutation_test_sc(
  factor_expr,
  gene_expr,
  coords,
  radius,
  sigma = NULL,
  metric = c("moran", "ind"),
  n_perm = 999,
  seed = NULL,
  verbose = TRUE
)
}
\arguments{
\item{factor_expr}{Factor gene expression (length n_cells)}

\item{gene_expr}{Gene expression matrix (genes x cells)}

\item{coords}{Cell coordinates (n x 2 matrix)}

\item{radius}{Radius for Gaussian weights}

\item{sigma}{Gaussian sigma (default: radius/3)}

\item{metric}{"moran" or "ind" (I_ND)}

\item{n_perm}{Number of permutations (default: 999)}

\item{seed}{Random seed (default: NULL)}

\item{verbose}{Print progress (default: TRUE)}
}
\value{
Data frame with columns: gene_idx, I_obs, p_value, z_score, p_adj
}
\description{
Tests spatial correlation between a factor gene and all other genes.
More efficient than pairwise test when analyzing one factor.
}
\details{
This function is optimized for testing one factor against many genes:
\enumerate{
\item Computes spatial lag for each gene once
\item Permutes factor expression (not gene expression)
\item Uses same permutation indices across all genes
}

This is more efficient than pairwise test when you only care about
correlations with a specific factor gene.
}
