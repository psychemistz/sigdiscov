% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weights_visium.R
\name{pairwise_moran_circular}
\alias{pairwise_moran_circular}
\title{Compute Pairwise Moran's I with Circular Weights}
\usage{
pairwise_moran_circular(
  data,
  coords,
  radius,
  sigma = 100,
  include_self = FALSE,
  mode = "paired",
  verbose = TRUE
)
}
\arguments{
\item{data}{Gene expression matrix (genes x spots). Will be z-normalized.}

\item{coords}{Spot coordinates (see \code{\link{create_circular_weights_visium}}).}

\item{radius}{Distance cutoff for weight matrix.}

\item{sigma}{RBF kernel bandwidth. Default: 100.}

\item{include_self}{Include self-connections. Default: FALSE.}

\item{mode}{Calculation mode: "paired" (all pairs) or "single" (univariate).}

\item{verbose}{Print progress. Default: TRUE.}
}
\value{
A list containing:
\item{moran}{Moran's I matrix (if mode = "paired") or vector (if mode = "single")}
\item{gene_names}{Names of genes}
\item{weight_sum}{Sum of weights used (S0)}
\item{W}{The weight matrix used}
}
\description{
Convenience function that creates circular RBF weights and computes
pairwise Moran's I in one step. Matches the SpaCET workflow.
}
\examples{
\dontrun{
# One-step pairwise Moran's I with circular weights
result <- pairwise_moran_circular(
  data_vst,
  coords,
  radius = 200,
  sigma = 100
)
}

}
\seealso{
\code{\link{create_circular_weights_visium}}, \code{\link{pairwise_moran_custom}}
}
