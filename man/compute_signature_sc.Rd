% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/signature_sc.R
\name{compute_signature_sc}
\alias{compute_signature_sc}
\title{Compute Spatial Signature for Single-Cell Data}
\usage{
compute_signature_sc(
  data,
  factor_gene,
  sender_type,
  receiver_type,
  radii = c(10, 20, 30, 50, 100, 200, 300, 500),
  metric = c("ind", "moran"),
  quantile_prob = 0.25,
  compute_delta = TRUE,
  n_perm = 0,
  min_cells = 10,
  min_connections = 10,
  seed = NULL,
  verbose = TRUE
)
}
\arguments{
\item{data}{SCData list (from load_data_cosmx, load_data_anndata, or as_data_sc)}

\item{factor_gene}{Character. Name of the factor gene (e.g., "IL1B")}

\item{sender_type}{Character. Sender cell type name}

\item{receiver_type}{Character. Receiver cell type name}

\item{radii}{Numeric vector. Distance radii in micrometers
(default: c(10, 20, 30, 50, 100, 200, 300, 500))}

\item{metric}{Character. Metric to compute: "ind" or "moran" (default: "ind")}

\item{quantile_prob}{Numeric. Quantile for sender expression filter
(default: 0.25, meaning keep top 75 percent of sender-type cells)}

\item{compute_delta}{Logical. Compute delta I (default: TRUE)}

\item{n_perm}{Integer. Number of permutations (default: 0)}

\item{min_cells}{Integer. Minimum cells (default: 10)}

\item{min_connections}{Integer. Minimum neighbors (default: 10)}

\item{seed}{Integer. Random seed (optional)}

\item{verbose}{Logical. Print progress (default: TRUE)}
}
\value{
ScSignature data.frame with columns: gene, I_r1/r2/..., I_r1 (first radius),
I_max, delta_I, p_value, p_adj, z_score (depending on options)
}
\description{
Main analysis function for computing spatial correlation signatures in
single-cell spatial transcriptomics data. Matches Python genomewide_interaction
implementation.
}
\details{
This function implements the single-cell spatial analysis workflow:

(1) Sender Definition: Cells of sender_type with factor expression above
the quantile threshold (default: top 75 percent).

(2) Receiver Definition: All cells of receiver_type.

(3) Weight Matrix: Gaussian weights with sigma = radius/3, row-normalized.

(4) Metric: I_ND (cosine similarity) or Moran's I.
}
\examples{
\dontrun{
# Load data
data <- load_data_cosmx("expression.csv", "metadata.csv")

# Compute signature
sig <- compute_signature_sc(
    data,
    factor_gene = "IL1B",
    sender_type = "Macrophage",
    receiver_type = "Fibroblast",
    n_perm = 999
)

# Top responding genes
head(sig[order(-sig$I_r1), ], 20)
}

}
\seealso{
\code{\link{load_data_cosmx}}, \code{\link{define_sender_receiver_sc}},
\code{\link{create_weights_sc}}
}
