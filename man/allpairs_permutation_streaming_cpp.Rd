% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{allpairs_permutation_streaming_cpp}
\alias{allpairs_permutation_streaming_cpp}
\title{Streaming Permutation Test for Pairwise Moran's I (Memory Efficient)}
\usage{
allpairs_permutation_streaming_cpp(
  data,
  coords,
  radius,
  sigma = -1,
  n_perm = 999L,
  seed = 0L,
  verbose = TRUE
)
}
\arguments{
\item{data}{Gene expression matrix (genes x cells). Will be z-normalized.}

\item{coords}{Cell coordinates (n x 2 matrix)}

\item{radius}{Radius for Gaussian weights}

\item{sigma}{Gaussian sigma (default: radius/3)}

\item{n_perm}{Number of permutations (default: 999)}

\item{seed}{Random seed (0 = random, default: 0)}

\item{verbose}{Print progress messages (default: TRUE)}
}
\value{
List with observed, sum, sum_sq, count_extreme, weight_sum, n_edges
}
\description{
Performs permutation test without storing dense weight matrix.
Uses KD-tree neighbor lists to compute spatial lag on-the-fly for each
permutation, accumulating statistics incrementally.
}
\details{
Memory usage: O(n_cells × avg_neighbors) for neighbor lists +
O(n_genes × n_cells) for data/lag + O(n_genes²) for accumulators

For 98k cells with 5k neighbors: ~1.7 GB instead of 77 GB with dense W.
}
