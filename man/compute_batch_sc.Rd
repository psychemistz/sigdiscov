% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/batch_sc.R
\name{compute_batch_sc}
\alias{compute_batch_sc}
\title{Compute I_ND for All Cell Type Pairs}
\usage{
compute_batch_sc(
  data,
  factor_genes = NULL,
  radii = c(10, 20, 30, 50, 100, 200, 300, 500),
  quantile_prob = 0.25,
  exclude_self = TRUE,
  min_cells = 10,
  min_connections = 10,
  output_file = NULL,
  verbose = TRUE
)
}
\arguments{
\item{data}{SCData list (from load_data_cosmx or similar)}

\item{factor_genes}{Character vector. Factor gene names (NULL = all genes)}

\item{radii}{Numeric vector. Distance radii in micrometers
(default: c(10, 20, 30, 50, 100, 200, 300, 500))}

\item{quantile_prob}{Numeric. Quantile threshold (default: 0.25 = top 75 percent)}

\item{exclude_self}{Logical. Exclude same-type pairs (default: TRUE)}

\item{min_cells}{Integer. Minimum cells per type (default: 10)}

\item{min_connections}{Integer. Minimum neighbors (default: 10)}

\item{output_file}{Character. Optional HDF5 output path (requires rhdf5)}

\item{verbose}{Logical. Print progress (default: TRUE)}
}
\value{
List with components:
\itemize{
\item IND_array: 4D array (pairs x radii x factors x genes)
\item pairs: Character vector of pair names ("sender->receiver")
\item radii: Numeric vector of radii
\item factor_genes: Character vector of factor gene names
\item target_genes: Character vector of all gene names
\item cell_types: Character vector of valid cell types
}
}
\description{
Batch computation of I_ND for all cell type pairs across multiple radii.
Matches Python genomewide_interaction output format (4D array).
}
\details{
This function computes the full I_ND matrix for all cell type pairs,
producing output compatible with Python analysis pipelines. The 4D array
can be indexed as: \code{IND_array[pair, radius, factor, gene]}
}
\examples{
\dontrun{
# Load data
data <- load_data_cosmx("expression.csv", "metadata.csv")

# Compute for specific factors
result <- compute_batch_sc(
    data,
    factor_genes = c("IL1B", "IL6", "TGFB1", "IFNG"),
    output_file = "IND_matrix.h5"
)

# Access specific result
# result$IND_array[pair_idx, radius_idx, factor_idx, gene_idx]
}

}
\seealso{
\code{\link{compute_signature_sc}}, \code{\link{save_hdf5_sc}},
\code{\link{load_hdf5_sc}}
}
