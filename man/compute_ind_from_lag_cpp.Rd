% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{compute_ind_from_lag_cpp}
\alias{compute_ind_from_lag_cpp}
\title{Compute I_ND (Cosine Similarity) from Pre-computed Spatial Lag}
\usage{
compute_ind_from_lag_cpp(z_f, lag_g)
}
\arguments{
\item{z_f}{Standardized factor expression vector (length n)}

\item{lag_g}{Pre-computed spatial lag of gene (W * z_g)}
}
\value{
Scalar I_ND value bounded between -1 and 1, or NA if norms are too small
}
\description{
Calculates the normalized directional Moran's I (I_ND) using:
I_ND = z_f' * lag_g / (||z_f|| * ||lag_g||)
}
\details{
This is equivalent to the cosine similarity between z_f and lag_g.

I_ND is the cosine of the angle between z_f and the spatial lag of z_g.
It is bounded between -1 and 1, making it interpretable as a correlation:
+1: Perfect positive spatial association
0: No spatial association
-1: Perfect negative spatial association

Returns NA if either vector has near-zero norm (constant or zero expression).
}
