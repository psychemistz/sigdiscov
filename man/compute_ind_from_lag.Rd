% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metrics.R
\name{compute_ind_from_lag}
\alias{compute_ind_from_lag}
\title{Compute I_ND (Cosine Similarity) from Pre-computed Spatial Lag}
\usage{
compute_ind_from_lag(z_f, lag_g)
}
\arguments{
\item{z_f}{Numeric vector. Standardized factor expression (length n).}

\item{lag_g}{Numeric vector. Spatial lag of gene expression (W * z_g).}
}
\value{
Scalar I_ND value bounded between -1 and 1, or NA if norms are too small.
}
\description{
Calculates the normalized directional Moran's I (I_ND) using cosine
similarity between factor expression and spatial lag of gene expression.
}
\details{
The I_ND is computed as cosine similarity:
\deqn{I_{ND} = \frac{z_f' \cdot lag_g}{\|z_f\| \cdot \|lag_g\|}}

This metric is bounded between -1 and 1, making it interpretable as a
correlation coefficient.
}
\examples{
z_f <- rnorm(100)
lag_g <- rnorm(100)
compute_ind_from_lag(z_f, lag_g)

}
\seealso{
Other core: 
\code{\link{compute_metric_batch}()},
\code{\link{compute_moran_from_lag}()},
\code{\link{compute_spatial_lag}()},
\code{\link{compute_spatial_lag_batch}()}
}
\concept{core}
