% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/signature_visium.R
\name{pairwise_moran}
\alias{pairwise_moran}
\title{Pairwise Moran's I Matrix Computation}
\usage{
pairwise_moran(
  data,
  coords,
  max_radius = 3,
  platform = "visium",
  same_spot = FALSE,
  mode = "paired",
  verbose = TRUE
)
}
\arguments{
\item{data}{Numeric matrix. Expression data (genes x spots), typically VST-transformed.}

\item{coords}{Data frame or matrix. Spot coordinates with row/col columns.}

\item{max_radius}{Integer. Maximum neighbor ring (default: 3).}

\item{platform}{Character. Platform type (default: "visium").}

\item{same_spot}{Logical. Include same-spot comparisons (default: FALSE).}

\item{mode}{Character. Computation mode: "paired" (default).}

\item{verbose}{Logical. Print progress (default: TRUE).}
}
\value{
Numeric matrix (n_genes x n_genes) of Moran's I values at the first radius.
}
\description{
Computes Moran's I for all gene pairs across multiple radii.
This is the classic pairwise analysis from pre-processed VST data.
}
\details{
This function computes the classic pairwise Moran's I matrix where each
entry (i,j) represents the spatial correlation between gene i and gene j.

The computation uses binary weights where spots within the specified
radius are neighbors (weight = 1/n_neighbors).
}
\examples{
\dontrun{
# Load VST-transformed data
data <- read.table("vst.tsv", header=TRUE, row.names=1)
colnames(data) <- gsub("X", "", colnames(data))
data <- as.matrix(data)

# Parse spot coordinates
spot_coords <- parse_spot_names(colnames(data))

# Compute pairwise Moran's I
result <- pairwise_moran(data, spot_coords, max_radius = 3)
result[1:5, 1:5]
}

}
