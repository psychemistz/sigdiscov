% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weights_sc.R
\name{create_annular_weights_sc}
\alias{create_annular_weights_sc}
\title{Create Annular (Ring) Weight Matrix for Cell Type Pair Analysis}
\usage{
create_annular_weights_sc(
  sender_coords,
  receiver_coords,
  outer_radius,
  inner_radius = 0,
  sigma = NULL,
  verbose = FALSE
)
}
\arguments{
\item{sender_coords}{Sender cell coordinates (n_sender x 2)}

\item{receiver_coords}{Receiver cell coordinates (n_receiver x 2)}

\item{outer_radius}{Outer radius (maximum distance)}

\item{inner_radius}{Inner radius (minimum distance, default: 0)}

\item{sigma}{Gaussian sigma (default: outer_radius/3)}

\item{verbose}{Print progress (default: FALSE)}
}
\value{
List with W (sparse matrix), weight_sum, n_edges
}
\description{
Creates a weight matrix using only neighbors within an annular region
(ring) defined by inner and outer radii. Useful for isolating
sender-receiver relationships at specific distance ranges.
}
\details{
For annular mode, only neighbors with distance d where
inner_radius <= d <= outer_radius are included.

Uses KD-tree for efficient neighbor search (O(n log n)).
Cross-platform: works on Mac (Intel/M1), Linux, Windows.
}
\examples{
\dontrun{
# Circular weights (all within radius)
W_circ <- create_annular_weights_sc(sender, receiver, outer_radius = 200)

# Annular weights (ring from 100 to 200 microns)
W_ring <- create_annular_weights_sc(sender, receiver,
                                    outer_radius = 200,
                                    inner_radius = 100)
}

}
