% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{compute_metric_batch_cpp}
\alias{compute_metric_batch_cpp}
\title{Batch Compute Metrics for All Genes}
\usage{
compute_metric_batch_cpp(z_f, lag_G, metric)
}
\arguments{
\item{z_f}{Standardized factor expression (length n)}

\item{lag_G}{Pre-computed spatial lag matrix (n x n_genes)
Each column is W * z_g for one gene}

\item{metric}{String: "moran" or "ind"}
}
\value{
Numeric vector of metric values (length n_genes)
}
\description{
Efficiently computes Moran's I or I_ND for one factor against all genes
using pre-computed spatial lag matrix.
}
\details{
This is the workhorse function for genome-wide analysis: compute the
spatial lag matrix once (W * Z_g), then call this function to get
metrics for all genes in one vectorized operation.

For "moran": I_g = z_f' * lag_G_g / n for each gene g
For "ind": I_g = z_f' * lag_G_g / (||z_f|| * ||lag_G_g||) for each gene g

The function is optimized using vectorized operations where possible.
}
