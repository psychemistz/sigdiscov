% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weights_visium.R
\name{create_circular_weights_visium}
\alias{create_circular_weights_visium}
\title{Create Circular RBF Weight Matrix for Visium}
\usage{
create_circular_weights_visium(
  coords,
  radius,
  sigma = 100,
  include_self = FALSE,
  sparse = TRUE
)
}
\arguments{
\item{coords}{Spot coordinates. Can be:
\itemize{
\item A matrix with columns for x/y coordinates (in physical units like micrometers)
\item A data frame with columns 'x' and 'y', or 'coordinate_x_um' and 'coordinate_y_um'
}}

\item{radius}{Distance cutoff in the same units as coords. Only spots within
this radius are connected. For Visium, typical values are 100-500 um.}

\item{sigma}{RBF kernel bandwidth. Default: 100. Controls distance decay rate.}

\item{include_self}{Include self-connections (diagonal). Default: FALSE.}

\item{sparse}{Return sparse matrix (TRUE) or dense matrix (FALSE). Default: TRUE.}
}
\value{
A list with components:
\item{W}{Weight matrix (sparse or dense)}
\item{weight_sum}{Sum of all weights (S0 for Moran's I normalization)}
}
\description{
Creates a spatial weight matrix using RBF kernel with circular (Euclidean)
distance cutoff. This matches the SpaCET calWeights behavior for spatial
correlation analysis.
}
\details{
The weight between spots i and j is computed as:
\deqn{w_{ij} = \exp\left(-\frac{d_{ij}^2}{2\sigma^2}\right) \text{ if } d_{ij} \leq r}

where \eqn{d_{ij}} is the Euclidean distance.

This is the recommended weight function for spatial correlation analysis as it:
\itemize{
\item Uses circular (Euclidean) distance instead of rectangular grid
\item Applies continuous distance decay via RBF kernel
\item Is consistent with SpaCET's approach
}
}
\examples{
\dontrun{
# Load Visium data with physical coordinates
coords <- data.frame(
  x = visium_data$coords$coordinate_x_um,
  y = visium_data$coords$coordinate_y_um
)

# Create weight matrix with 200um radius
W_result <- create_circular_weights_visium(coords, radius = 200, sigma = 100)

# Use for pairwise Moran's I
result <- pairwise_moran_custom(data, W_result$W)
}

}
\seealso{
\code{\link{create_weights_visium}}, \code{\link{pairwise_moran_custom}}
}
