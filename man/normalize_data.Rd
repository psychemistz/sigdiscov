% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocess.R
\name{normalize_data}
\alias{normalize_data}
\title{Normalize Expression Data}
\usage{
normalize_data(
  counts,
  method = c("lognorm", "logcpm", "vst"),
  scale_factor = NULL,
  verbose = TRUE
)
}
\arguments{
\item{counts}{A matrix or sparse matrix of raw counts (genes x cells/spots).}

\item{method}{Character. Normalization method: "lognorm" (default), "logcpm",
or "vst".}

\item{scale_factor}{Numeric. Scale factor for lognorm/logcpm (default: 10000
for lognorm, 1e6 for logcpm).}

\item{verbose}{Logical. Print progress messages (default: TRUE).}
}
\value{
Normalized expression matrix (same dimensions as input).
}
\description{
Normalize raw count data using various methods. LogNorm is recommended for
large single-cell datasets (CosMx, Xenium, MERFISH) where VST is too slow.
}
\details{
Three normalization methods are supported:

\strong{lognorm (recommended for large datasets)}:
\deqn{y_{ij} = \log(1 + \frac{x_{ij}}{\sum_j x_{ij}} \times 10000)}
Fast and provides ~80\% of VST performance for spatial correlation analysis.
Default in Seurat for single-cell data.

\strong{logcpm}:
\deqn{y_{ij} = \log(1 + \frac{x_{ij}}{\sum_j x_{ij}} \times 10^6)}
Similar to lognorm but with scale factor of 1 million (CPM).

\strong{vst}:
Variance stabilizing transformation using sctransform. Most accurate but
computationally expensive for large datasets. Requires sctransform package.

Performance comparison (CytoSig correlation):
\itemize{
\item VST: 0.051 (baseline)
\item lognorm: 0.040 (78\% of VST)
\item logcpm: 0.020 (39\% of VST)
}
}
\examples{
\dontrun{
# Fast normalization for CosMx (recommended)
norm_data <- normalize_data(counts, method = "lognorm")

# VST for smaller Visium datasets
norm_data <- normalize_data(counts, method = "vst")

# Custom scale factor
norm_data <- normalize_data(counts, method = "lognorm", scale_factor = 1e4)
}

}
\seealso{
\code{\link{load_data_visium}}, \code{\link{load_data_cosmx}}
}
