% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/celltype_pair_analysis.R
\name{apply_fdr_correction}
\alias{apply_fdr_correction}
\title{Apply FDR Correction to Spatial Analysis Results}
\usage{
apply_fdr_correction(results, alpha = 0.05, method = "BH")
}
\arguments{
\item{results}{Data frame with 'pvalue' column, or CellTypePairResult object}

\item{alpha}{FDR threshold (default: 0.05)}

\item{method}{P-value adjustment method (default: "BH" for Benjamini-Hochberg)}
}
\value{
Results with added columns: p_adj (adjusted p-values), significant (logical)
}
\description{
Applies Benjamini-Hochberg FDR correction to p-values from
permutation testing or other significance tests.
}
\details{
Supports multiple input types:
\itemize{
\item CellTypePairResult objects with a pvalue component
\item Data frames with a 'pvalue' column
}

Available methods (passed to \code{stats::p.adjust}):
\itemize{
\item "BH" or "fdr": Benjamini-Hochberg (default, controls FDR)
\item "bonferroni": Bonferroni (controls FWER, conservative)
\item "holm": Holm-Bonferroni (controls FWER)
\item "BY": Benjamini-Yekutieli (controls FDR under dependence)
}
}
\examples{
\dontrun{
# Correct p-values from permutation test
results <- data.frame(
    gene = paste0("Gene", 1:100),
    pvalue = runif(100, 0, 1)
)
corrected <- apply_fdr_correction(results, alpha = 0.05)

# View significant results
significant_genes <- corrected[corrected$significant, ]
}

}
