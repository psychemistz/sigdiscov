% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{pairwise_moran_streaming_cpp}
\alias{pairwise_moran_streaming_cpp}
\title{Compute Pairwise Moran's I with Streaming Lag (No Neighbor Limit, No W Storage)}
\usage{
pairwise_moran_streaming_cpp(
  data,
  coords,
  radius,
  sigma = -1,
  n_threads = 0L,
  verbose = TRUE
)
}
\arguments{
\item{data}{Gene expression matrix (genes x cells)}

\item{coords}{Cell coordinates (n x 2 matrix)}

\item{radius}{Radius for neighbor search}

\item{sigma}{Gaussian sigma (default: radius/3)}

\item{n_threads}{Number of threads (default: 0 = auto, ignored if OpenMP unavailable)}

\item{verbose}{Print progress messages (default: TRUE)}
}
\value{
List with moran matrix, weight_sum, and n_edges
}
\description{
Best approach for CPU: uses KD-tree for O(n log n) neighbor search,
computes spatial lag on-the-fly without storing weight matrix W.
Unlimited neighbors without memory explosion.
}
\details{
Memory usage: O(n_genes Ã— n_cells) for data + lag matrices only.
Uses OpenMP for parallel processing across cells when available.
}
